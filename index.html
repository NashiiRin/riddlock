<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>指定のWebサイト</title>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            font-family: sans-serif;
            overflow: hidden; 
        }

        body {
            background-color: #1a1a1a; 
            color: #f0f0f0; 
            position: relative; 
        }

        .right-container {
            position: absolute;
            top: 0;
            right: 0;
            width: 50%; 
            height: 100vh; 
            padding: 20px;
            box-sizing: border-box; 
            display: flex;
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            gap: 20px;
        }

        .image-stack-container {
            position: relative; 
            display: flex; 
            justify-content: center;
            align-items: center;
            width: 100%; 
            height: auto; 
            z-index: 10; 
        }

        .background-image {
            max-width: 70%; 
            height: auto;
            display: block; 
        }

        .overlay-content {
            position: absolute; 
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%); 
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%; 
            height: 100%; 
            gap: 10px; 
        }
        
        .overlay-button {
            max-width: 35%; 
            height: auto;
        }
        
        .overlay-button.button-small {
            max-width: 17.5%; 
        }

        .overlay-button:active {
            filter: brightness(0.7); 
        }

        .mic-icon {
            max-width: 20%; 
            height: auto;
            margin-bottom: 10px;
        }

        /* --- アニメーション用スタイル --- */

        #animation-container {
            position: absolute;
            top: 50%; 
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%; 
            height: 400px; 
            pointer-events: none; 
            z-index: 20; 
            overflow: visible; 
        }

        .animated-pic {
            position: absolute;
            max-width: 70%; 
            height: auto;
            opacity: 0; 
            transition: opacity 0.3s ease; 
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .single-display-pic {
            position: absolute; 
            max-width: 70%; 
            height: auto;
            opacity: 0;
            transition: opacity 0.3s ease;
            top: 50%; 
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .countdown-pic {
            position: absolute; 
            max-width: 50%; 
            height: auto;
            opacity: 0;
            transition: opacity 0.3s ease;
            top: 70%; 
            left: 50%;
            transform: translate(-50%, -50%); 
        }

    </style>
</head>
<body>

    <div class="right-container">
        
        <div class="image-stack-container">
            <img src="pic-01.png" alt="Pic 01" class="background-image">
            <div class="overlay-content">
                <img src="button-01.png" alt="スキャン開始ボタン" class="overlay-button" id="scanButton">
            </div>
        </div>
        
        <div class="image-stack-container">
            <img src="pic-02.png" alt="Pic 02" class="background-image">
            <div class="overlay-content">
                <img src="mic.png" alt="マイクアイコン" class="mic-icon">
                <img src="button-02.png" alt="OKボタン" class="overlay-button button-small">
            </div>
        </div>

        <div id="animation-container"></div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            document.body.addEventListener('touchstart', function() {}, false);

            const scanButton = document.getElementById('scanButton');
            const animationContainer = document.getElementById('animation-container');
            
            const imagesToShow = [
                'pic-03.png',
                'pic-04.png',
                'pic-05.png',
                'pic-06.png',
                'pic-07.png'
            ];
            
            const countdownImages = [
                'pic-09.png', // 5
                'pic-10.png', // 4
                'pic-11.png', // 3
                'pic-12.png', // 2
                'pic-13.png'  // 1
            ];

            let animationStarted = false;

            if (scanButton) {
                scanButton.addEventListener('click', function() {
                    if (animationStarted) return; 
                    animationStarted = true;

                    animationContainer.innerHTML = ''; 

                    const displayedImages = [];

                    imagesToShow.forEach((src, index) => {
                        setTimeout(() => {
                            const img = document.createElement('img');
                            img.src = src;
                            img.className = 'animated-pic';
                            
                            const offset = index * 25; 
                            img.style.transform = `translate(calc(-50% + ${offset}px), calc(-50% + ${offset}px))`;
                            
                            animationContainer.appendChild(img);
                            displayedImages.push(img); 
                            
                            setTimeout(() => {
                                img.style.opacity = 1;
                            }, 50); 

                        }, index * 500); 
                    });

                    const lastImageTime = (imagesToShow.length - 1) * 500;
                    const cleanupTime = lastImageTime + 600; 

                    setTimeout(() => {
                        displayedImages.forEach(img => {
                            img.style.opacity = 0;
                        });

                        setTimeout(() => {
                            animationContainer.innerHTML = ''; 
                            
                            // pic-08.png の表示
                            setTimeout(() => {
                                const pic08 = document.createElement('img');
                                pic08.src = 'pic-08.png';
                                pic08.className = 'single-display-pic'; 
                                animationContainer.appendChild(pic08);

                                setTimeout(() => {
                                    pic08.style.opacity = 1;
                                }, 50);

                                // 0.7秒後にフェードアウトして「次のシーケンスへ」
                                setTimeout(() => {
                                    pic08.style.opacity = 0;
                                    
                                    setTimeout(() => {
                                        if (pic08.parentNode) {
                                            pic08.parentNode.removeChild(pic08);
                                        }
                                        
                                        // ★ここからカウントダウンシーケンス★
                                        
                                        // ★変更点★ 表示した画像を保持する配列
                                        const displayedCountdownImages = []; 

                                        countdownImages.forEach((src, index) => {
                                            setTimeout(() => {
                                                // ★変更点★ 現在の画像をフェードアウトする処理を削除

                                                // 2. 新しい画像を準備
                                                const img = document.createElement('img');
                                                img.src = src;
                                                img.className = 'countdown-pic'; 
                                                animationContainer.appendChild(img);
                                                // ★変更点★ 配列に追加
                                                displayedCountdownImages.push(img); 

                                                // 3. わずかな遅延の後、フェードイン
                                                setTimeout(() => {
                                                    img.style.opacity = 1;
                                                }, 50); 

                                                // 4. 最後の画像(pic-13)が表示された場合
                                                if (index === countdownImages.length - 1) {
                                                    // 1秒後に「すべて」の画像を消す
                                                    setTimeout(() => {
                                                        // ★変更点★ 配列の画像をすべて消す
                                                        displayedCountdownImages.forEach(img => {
                                                            img.style.opacity = 0;
                                                        });
                                                        
                                                        setTimeout(() => {
                                                            animationContainer.innerHTML = '';
                                                            animationStarted = false; // リセット
                                                        }, 300); // フェードアウト
                                                    }, 1000); // 最後の画像表示から1秒後
                                                }

                                            }, index * 1000); // 1秒おき
                                        });

                                    }, 300); // pic-08のフェードアウト

                                }, 700); // 0.7秒間表示
                            }, 400); 

                        }, 300); 

                    }, cleanupTime);
                });
            }
        });
    </script>
</body>
</html>

